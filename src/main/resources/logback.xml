<?xml version="1.0" encoding="UTF-8"?>
<!--
    Конфігураційний файл для бібліотеки логування Logback.
    Logback використовується для запису повідомлень про події, що відбуваються в додатку,
    таких як інформаційні повідомлення, попередження та помилки.
    Цей файл визначає, куди (наприклад, у консоль, у файл) та в якому форматі
    будуть записуватися лог-повідомлення.
-->
<configuration>

    <!--
        Апендер (Appender) для виводу лог-повідомлень у консоль.
        Це корисно для відстеження роботи програми в реальному часі під час розробки.
    -->
    <appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
        <!--
            Кодувальник (Encoder) визначає формат виводу лог-повідомлень.
            Шаблон (pattern) задає структуру кожного запису в лозі.
        -->
        <encoder>
            <!--
                Шаблон форматування:
                %d{HH:mm:ss.SSS} - Час у форматі Години:Хвилини:Секунди.Мілісекунди
                [%thread] - Назва потоку, в якому було згенеровано повідомлення
                %-5level - Рівень логування (DEBUG, INFO, WARN, ERROR), вирівняний по лівому краю, 5 символів
                %logger{36} - Назва логера (зазвичай повне ім'я класу), скорочена до 36 символів
                - %msg%n - Текст лог-повідомлення та перехід на новий рядок
            -->
            <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
        </encoder>
    </appender>

    <!--
        Апендер для запису лог-повідомлень у файл.
        Це дозволяє зберігати історію подій для подальшого аналізу або відлагодження.
        Використовується RollingFileAppender, що дозволяє автоматично керувати ротацією файлів логів.
    -->
    <appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <!-- Шлях до основного файлу логів. Нові записи будуть додаватися сюди. -->
        <file>logs/bookdiary.log</file>

        <!--
            Політика ротації файлів (Rolling Policy).
            TimeBasedRollingPolicy означає, що ротація буде відбуватися на основі часу.
        -->
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <!--
                Шаблон імені файлу для архівних (ротованих) логів.
                %d{yyyy-MM-dd} - дата у форматі Рік-Місяць-День.
                Наприклад, логи за 27 травня 2025 року будуть збережені як 'bookdiary.2025-05-27.log'.
            -->
            <fileNamePattern>logs/bookdiary.%d{yyyy-MM-dd}.log</fileNamePattern>
            <!--
                Максимальна кількість днів, за які зберігатимуться архівні файли логів.
                Старіші файли будуть автоматично видалятися.
            -->
            <maxHistory>30</maxHistory>
            <!--
                Загальний максимальний розмір всіх архівних файлів логів.
                Якщо загальний розмір перевищить це значення, найстаріші файли будуть видалені,
                навіть якщо їх вік менший за maxHistory.
            -->
            <totalSizeCap>100MB</totalSizeCap>
        </rollingPolicy>

        <!-- Кодувальник для форматування записів у файлі логів. -->
        <encoder>
            <!--
                Шаблон форматування для файлу (може відрізнятися від консольного):
                %d{yyyy-MM-dd HH:mm:ss.SSS} - Повна дата та час
                Інші елементи аналогічні консольному шаблону.
            -->
            <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
        </encoder>
    </appender>

    <!--
        Кореневий логер (Root Logger).
        Визначає рівень логування за замовчуванням для всього додатку та
        встановлює, які апендери будуть використовуватися для запису повідомлень.
        Рівень "INFO" означає, що будуть записуватися повідомлення рівня INFO, WARN та ERROR.
        Повідомлення рівня DEBUG та TRACE будуть ігноруватися, якщо не перевизначено для конкретних пакетів.
    -->
    <root level="INFO">
        <appender-ref ref="CONSOLE" /> <!-- Підключення консольного апендера -->
        <appender-ref ref="FILE" />    <!-- Підключення файлового апендера -->
    </root>

    <!--
        Специфічне налаштування рівня логування для пакету, що містить класи доступу до даних (DAO).
        Для пакету 'com.student.bookdiary.persistence' встановлено рівень "DEBUG".
        Це означає, що для класів у цьому пакеті будуть записуватися повідомлення рівня DEBUG,
        INFO, WARN та ERROR, що дозволяє отримувати більш детальну інформацію про роботу
        з базою даних під час розробки та відлагодження.
    -->
    <logger name="com.student.bookdiary.persistence" level="DEBUG" />

</configuration>